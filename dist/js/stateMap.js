!function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,a){"use strict";var n=[{id:1,abbr:"AL",name:"Alabama"},{id:2,abbr:"AK",name:"Alaska"},{id:4,abbr:"AZ",name:"Arizona"},{id:5,abbr:"AR",name:"Arkansas"},{id:6,abbr:"CA",name:"California"},{id:8,abbr:"CO",name:"Colorado"},{id:9,abbr:"CT",name:"Connecticut"},{id:10,abbr:"DE",name:"Delaware"},{id:11,abbr:"DC",name:"District of Columbia"},{id:12,abbr:"FL",name:"Florida"},{id:13,abbr:"GA",name:"Georgia"},{id:15,abbr:"HI",name:"Hawaii"},{id:16,abbr:"ID",name:"Idaho"},{id:17,abbr:"IL",name:"Illinois"},{id:18,abbr:"IN",name:"Indiana"},{id:19,abbr:"IA",name:"Iowa"},{id:20,abbr:"KS",name:"Kansas"},{id:21,abbr:"KY",name:"Kentucky"},{id:22,abbr:"LA",name:"Louisiana"},{id:23,abbr:"ME",name:"Maine"},{id:24,abbr:"MD",name:"Maryland"},{id:25,abbr:"MA",name:"Massachusetts"},{id:26,abbr:"MI",name:"Michigan"},{id:27,abbr:"MN",name:"Minnesota"},{id:28,abbr:"MS",name:"Mississippi"},{id:29,abbr:"MO",name:"Missouri"},{id:30,abbr:"MT",name:"Montana"},{id:31,abbr:"NE",name:"Nebraska"},{id:32,abbr:"NV",name:"Nevada"},{id:33,abbr:"NH",name:"New Hampshire"},{id:34,abbr:"NJ",name:"New Jersey"},{id:35,abbr:"NM",name:"New Mexico"},{id:36,abbr:"NY",name:"New York"},{id:37,abbr:"NC",name:"North Carolina"},{id:38,abbr:"ND",name:"North Dakota"},{id:39,abbr:"OH",name:"Ohio"},{id:40,abbr:"OK",name:"Oklahoma"},{id:41,abbr:"OR",name:"Oregon"},{id:42,abbr:"PA",name:"Pennsylvania"},{id:44,abbr:"RI",name:"Rhode Island"},{id:45,abbr:"SC",name:"South Carolina"},{id:46,abbr:"SD",name:"South Dakota"},{id:47,abbr:"TN",name:"Tennessee"},{id:48,abbr:"TX",name:"Texas"},{id:49,abbr:"UT",name:"Utah"},{id:50,abbr:"VT",name:"Vermont"},{id:51,abbr:"VA",name:"Virginia"},{id:53,abbr:"WA",name:"Washington"},{id:54,abbr:"WV",name:"West Virginia"},{id:55,abbr:"WI",name:"Wisconsin"},{id:56,abbr:"WY",name:"Wyoming"}];e.a=n},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(0),i=a(2),r={init:function(){this.height=820,this.width=960,this.borderColor="#ffffff",this.noDataColor="#dddddd",this.data=[],this.parsed=!1,this.sideRectXStart=890,this.sideRectYStart=265,this.sideRectOffset=40,this.identifiedBy="id",this.identifiedCol="",this.valueType="",this.valueCol="",this.reverseSequence=!1,this.summaryStats={min:0,mid:50,max:100},this.interpolator="Plasma",this.steps=5,r.firstDraw(),r.setupListeners()},firstDraw:function(){var t=d3.select("#map-container").append("svg").attr("id","the-svg").attr("width","100%").attr("viewBox","0 0 "+r.width+" "+r.height),e=d3.geoAlbersUsa().scale(1.3*r.width).translate([r.width/2,r.height-.6*r.height]),a=d3.geoPath().projection(e),s=t.append("g").attr("class","titles"),d=(s.append("text").attr("class","title").attr("style","font-family: 'Lato', Arial, sans-serif; font-size: 32px; font-style: normal; font-weight:700").attr("x",16).attr("y",37).text("Title"),s.append("text").attr("class","subtitle").attr("style","font-family: 'Lato', Arial, sans-serif; font-size: 18px; font-style: italic; font-weight:400").attr("x",19).attr("y",63).text("Subtitle"),t.append("g").attr("class","notes").append("text").attr("class","note").attr("x",16).attr("y",685).text("Notes and Source"),t.append("g").attr("class","states").attr("transform","translate(0, 45)")),o=t.append("g").attr("class","labels").attr("transform","translate(0, 45)");d3.queue().defer(d3.json,"data/us.json").await(function(t,e){d.selectAll("path").data(topojson.feature(e,e.objects.states).features).enter().append("path").attr("class",function(t){return"state state"+t.id}).attr("d",a).attr("fill",r.noDataColor).attr("stroke","#fff").attr("stroke-width",1.5),o.selectAll("g").data(topojson.feature(e,e.objects.states).features).enter().append("g").attr("class",function(t){return"labels labels"+t.id}).attr("transform",function(t){var e=a.centroid(t);return e[0]&&e[1]?i.a.LABEL_OFFSETS[t.id]?"translate("+(e[0]+i.a.LABEL_OFFSETS[t.id].x)+","+(e[1]+i.a.LABEL_OFFSETS[t.id].y)+")":"translate("+e[0]+","+e[1]+")":"translate(0,0)"}).append("text").attr("class",function(t){return"abbr"+t.id}).attr("text-anchor","middle").attr("style","font-family: 'Lato', Arial, sans-serif; font-size: 14px; font-style: normal; font-weight:700").text(function(t){var e=n.a.filter(function(e){return e.id==t.id});return e[0]?e[0].abbr:""});var s=0;offets.SIDE_RECT_STATES.forEach(function(t){console.log(t),d.append("rect").attr("x",r.sideRectXStart).attr("y",r.sideRectYStart+r.sideRectOffset*s).attr("width",12).attr("height",12).attr("fill",r.noDataColor).attr("class",function(){return"state state"+t}),d3.select(".labels"+t).attr("transform",function(t){return"translate("+(r.sideRectXStart-6)+","+(r.sideRectYStart+11+r.sideRectOffset*s)+")"}),d3.select(".abbr"+t).attr("text-anchor","end"),s++})})},redraw:function(){var t=[];r.data.forEach(function(e){var a=r.getFipsId(r.identifiedBy,e[r.identifiedCol]),n=e[r.valueCol];t.push({id:a,value:n})}),t.forEach(function(t){console.log(t.value,r.divergentColor(t.value)),d3.selectAll(".state"+t.id).attr("fill",r.sequenceColor(t.value))})},setupListeners:function(){var t=this;document.getElementById("title-text").addEventListener("input",function(){d3.select(".title").text(t.value)}),document.getElementById("subtitle-text").addEventListener("input",function(){d3.select(".subtitle").text(t.value)}),document.getElementById("notes-text").addEventListener("input",function(){d3.select(".note").text(t.value).call(r.wrap,550)}),document.getElementById("data-file").addEventListener("change",function(){r.readFile(t.files[0],r.parseFile)}),document.getElementById("identified-by").addEventListener("change",function(){r.identifiedBy=t.value,r.validateId()}),document.getElementById("identified-col").addEventListener("change",function(){r.identifiedCol=t.value,r.validateId()}),document.getElementById("value-type").addEventListener("change",function(){console.log("value type changed")}),document.getElementById("value-col").addEventListener("change",function(){r.valueColListener(t)}),document.getElementById("data-scale").addEventListener("change",function(){r.dataScaleListener(t)})},scaleSelect:function(t){var e=d3.select("#color-scales");e.attr("style",""),e.selectAll("*").remove();var a=void 0,n=void 0;switch(t){case"sequential":a=SEQUENTIAL_INTERPOLATORS,n=r.sequenceColor;break;case"divergent":a=DIVERGENT_INTERPOLATORS,n=r.divergentColor}a.forEach(function(t){for(var a=e.append("div").attr("class","scale-row").on("click",function(e){r.interpolator=t}),i=[0,r.steps-1],s=0;s<r.steps;s++){var d=n(s,i,t);a.append("div").attr("class","scale-step").attr("style","background-color: "+d)}})},wrap:function(t,e){var a=this;t.each(function(){for(var t=d3.select(a),n=t.text().split(/\s+/).reverse(),i=16,r="",s=[],d=0,o=t.attr("y"),l=parseFloat(t.attr("dy"))||0,c=t.text(null).append("tspan").attr("x",0).attr("y",o).attr("dy",l);r=n.pop();)s.push(r),c.text(s.join(" ")),c.node().getComputedTextLength()>e&&(s.pop(),c.text(s.join(" ")),s=[r],c=t.append("tspan").attr("x",0).attr("y",o).attr("dy",++d*i+l).text(r))})},readFile:function(t,e){var a=new FileReader;a.onload=function(a){"text/csv"!==t.type?alert("This file is not a comma-separated values file. This program only reads CSV files."):e(a.target.result)},a.readAsText(t)},parseFile:function(t){r.data=d3.csvParse(t),r.data.columns.forEach(function(t){d3.select("#identified-col").append("option").attr("value",t).text(t),d3.select("#value-col").append("option").attr("value",t).text(t)}),d3.select("#data-id-select").attr("style",""),d3.select("#data-value-select").attr("style","")},valueColListener:function(t){"default"!==t.value&&(d3.select("#data-scale-container").attr("style",""),d3.select("#data-stats").attr("style",""),r.valueCol=t.value)},dataScaleListener:function(t){var e=document.getElementById("mid-value");"divergent"!==t.value?e.disabled=!0:e.disabled=!1},getFipsId:function(t,e){return n.a.filter(function(a){return a[t]===e})[0].id},validateId:function(){var t=[],e=[];""!==r.identifiedCol&&"default"!==r.identifiedCol&&(r.data.forEach(function(a){var i=a[r.identifiedCol];void 0!==n.a.map(function(t){return t[r.identifiedBy]}).find(function(t){return t===i})?t.push(i):e.push(i)}),e.length?d3.select("#id-validation-message").attr("class","warning").text("Could not validate: "+e.join(", ")):e.length||d3.select("#id-validation-message").attr("class","valid").text("All IDs validated."))},sequenceColor:function(t,e,a,n){var e=e||[r.summaryStats.min,r.summaryStats.max];r.reverseSequence&&(e=[r.summaryStats.max,r.summaryStats.min]);var i=a||r.interpolator;return chroma.scale(i).domain(e).classes(n)(t).hex()},divergentColor:function(t,e,a){var e=e||[r.summaryStats.min,r.summaryStats.mid,r.summaryStats.max];r.reverseSequence&&(e=[r.summaryStats.max,r.summaryStats.mid,r.summaryStats.min]);var n=a||r.interpolator;return console.log(n),d3.scaleSequential().domain(e).clamp(!0)(t)}};!function(){r.init(r)}()},function(t,e,a){"use strict";var n={TOP_RECT_STATES:[33,50],SIDE_RECT_STATES:[9,10,11,24,25,34,44,54],LABEL_OFFSETS:{2:{x:5,y:-10},12:{x:25,y:20},13:{x:5,y:5},15:{x:0,y:0},17:{x:-5,y:-10},22:{x:-10,y:0},23:{x:0,y:-5},26:{x:15,y:22},27:{x:0,y:-20},36:{x:0,y:0},37:{x:0,y:0},45:{x:0,y:0},51:{x:0,y:0},55:{x:-3,y:-10}}};e.a=n}]);